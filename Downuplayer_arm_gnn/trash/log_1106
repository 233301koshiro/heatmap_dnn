(base) irsl@irsl-System-Product-Name:~/heatmap_dnn/Downuplayer_arm_gnn$ python debug.py   --epochs 200   --batch-size 8   --mask-mode one --mask-k 5  --seed 42   --save-dir checkpoints_debug   --log-csv checkpoints_debug/train_log.csv   --early-stop-patience 10 --min-delta 1e-4   --metrics-csv checkpoints_debug/test_metrics_origscale.csv   --normali
ze-by none
[check] num_features: 13
[check] feature_names: ['deg', 'depth', 'mass', 'jtype_is_revolute', 'jtype_is_continuous', 'jtype_is_prismatic', 'jtype_is_fixed', 'axis_x', 'axis_y', 'axis_z', 'origin_x', 'origin_y', 'origin_z']
[dataset] total graphs: 29

--- Graph 0 / 28 ---
=== GRAPH: ./merge_joint_robots/merge_a1.urdf ===
num_nodes: 13  |  num_edges: 12
---------------------------------------------------------------------------------------------------------------------------------
node_index | deg | depth |    mass | j_revo | j_cont | j_pris | j_fix | axis_x | axis_y | axis_z | origin_x | origin_y | origin_z
---------------------------------------------------------------------------------------------------------------------------------
         0 |   4 |     0 |   7.001 |      0 |      0 |      0 |     1 |      0 |      0 |      0 |        0 |        0 |        0
         1 |   2 |     1 | 0.69601 |      1 |      0 |      0 |     0 |      1 |      0 |      0 |   0.1805 |   -0.047 |        0
         2 |   2 |     2 |   1.013 |      1 |      0 |      0 |     0 |      0 |      1 |      0 |        0 |  -0.0838 |        0
         3 |   1 |     3 |   0.226 |      1 |      0 |      0 |     0 |      0 |      1 |      0 |        0 |        0 |     -0.2
         4 |   2 |     1 | 0.69601 |      1 |      0 |      0 |     0 |      1 |      0 |      0 |   0.1805 |    0.047 |        0
... (showing 5/13 nodes)
---------------------------------------------------------------------------------------------------------------------------------
各特徴量の 平均と/標準偏差でーーーーす
------------------------------------------------------------------------
col | feat               |         mean |          std
------------------------------------------------------------------------
  0 | deg                |      1.86818 |     0.874324
  1 | depth              |      3.60455 |      2.70403
  2 | mass               |      1.94831 |      6.55619
  3 | j_revo             |        0.775 |     0.417582
  4 | j_cont             |     0.143182 |     0.350258
  5 | j_pris             |    0.0159091 |     0.125124
  6 | j_fix              |    0.0659091 |     0.248123
  7 | axis_x             |     0.147727 |      0.39919
  8 | axis_y             |     0.263823 |     0.553208
  9 | axis_z             |     0.361364 |     0.496678
 10 | origin_x           |    0.0233882 |     0.107941
 11 | origin_y           |    0.0041514 |    0.0756294
 12 | origin_z           |  -0.00756957 |     0.136585
------------------------------------------------------------------------
[debug] nonfinite / extreme values: none
各特徴量の最小値/最大値（Min-Max正規化用）でーーーーす
minもmaxも0ということはその要素は出現しなかったでーーーーす(onehotとか)
------------------------------------------------------------------------
col | feat               |          min |          max
------------------------------------------------------------------------
  0 | deg                |            1 |            8
  1 | depth              |            0 |           11
  2 | mass               |        1e-06 |      97.2011
  3 | j_revo             |            0 |            1
  4 | j_cont             |            0 |            1
  5 | j_pris             |            0 |            1
  6 | j_fix              |            0 |            1
  7 | axis_x             |           -1 |            1
  8 | axis_y             |           -1 |            1
  9 | axis_z             |           -1 |            1
 10 | origin_x           |      -0.3735 |       0.3735
 11 | origin_y           |        -0.41 |        0.384
 12 | origin_z           |       -0.435 |        0.686
------------------------------------------------------------------------
min-maxで正規化したあとの特徴量のプレビューでーーーーす
さっき上で見せたグラフの特徴量の一部をブロックに分けて表示しまーーーーす
---- preview (normalized) ----
--------------------------------------------------------------------------------------------------------------------------
[block 1] normalized
--------------------------------------------------------------------------------------------------------------------------
row |   deg | depth |  mass | j_revo | j_cont | j_pris | j_fix | axis_x | axis_y | axis_z | origin_x | origin_y | origin_z
--------------------------------------------------------------------------------------------------------------------------
  0 | 0.429 |     0 | 0.072 |      0 |      0 |      0 |     1 |    0.5 |    0.5 |    0.5 |      0.5 |    0.516 |    0.388
  1 | 0.143 | 0.091 | 0.007 |      1 |      0 |      0 |     0 |      1 |    0.5 |    0.5 |    0.742 |    0.457 |    0.388
  2 | 0.143 | 0.182 |  0.01 |      1 |      0 |      0 |     0 |    0.5 |      1 |    0.5 |      0.5 |    0.411 |    0.388
  3 |     0 | 0.273 | 0.002 |      1 |      0 |      0 |     0 |    0.5 |      1 |    0.5 |      0.5 |    0.516 |     0.21
  4 | 0.143 | 0.091 | 0.007 |      1 |      0 |      0 |     0 |      1 |    0.5 |    0.5 |    0.742 |    0.576 |    0.388
--------------------------------------------------------------------------------------------------------------------------
再変換が正しく行われているか確認するためのオリジナルスケールの表示でーーーーす
---- preview (original scale) ----
------------------------------------------------------------------------------------------------------------------------
[block 1] original
------------------------------------------------------------------------------------------------------------------------
row | deg | depth |  mass | j_revo | j_cont | j_pris | j_fix | axis_x | axis_y | axis_z | origin_x | origin_y | origin_z
------------------------------------------------------------------------------------------------------------------------
  0 |   4 |     0 | 7.001 |      0 |      0 |      0 |     1 |      0 |      0 |      0 |        0 |        0 |        0
  1 |   2 |     1 | 0.696 |      1 |      0 |      0 |     0 |      1 |      0 |      0 |    0.181 |   -0.047 |        0
  2 |   2 |     2 | 1.013 |      1 |      0 |      0 |     0 |      0 |      1 |      0 |        0 |   -0.084 |        0
  3 |   1 |     3 | 0.226 |      1 |      0 |      0 |     0 |      0 |      1 |      0 |        0 |        0 |     -0.2
  4 |   2 |     1 | 0.696 |      1 |      0 |      0 |     0 |      1 |      0 |      0 |    0.181 |    0.047 |        0
------------------------------------------------------------------------------------------------------------------------
[dataset] total=29 | train=20 val=5 test=4
train_loader batches: 3
[MaskedTreeAE] masked nodes: [3, 43, 57, 62, 98, 117, 124, 129]
[MaskedTreeAE] masked nodes: [5, 27, 31, 36, 41, 66, 73, 78]
[MaskedTreeAE] masked nodes: [6, 24, 30, 43]
epoch 001 | train 0.5235 | val 0.3276 | 0.5s
[MaskedTreeAE] masked nodes: [2, 11, 41, 96, 134, 140, 160, 164]
[MaskedTreeAE] masked nodes: [0, 16, 68, 72, 79, 92, 105, 117]
[MaskedTreeAE] masked nodes: [0, 17, 36, 57]
[MaskedTreeAE] masked nodes: [17, 31, 42, 47, 52, 60, 66, 79]
[MaskedTreeAE] masked nodes: [4, 21, 23, 47, 72, 85, 134, 142]
[MaskedTreeAE] masked nodes: [6, 33, 71, 85]
[MaskedTreeAE] masked nodes: [8, 33, 48, 60, 98, 137, 140, 151]
[MaskedTreeAE] masked nodes: [13, 63, 72, 80, 98, 105, 107, 120]
[MaskedTreeAE] masked nodes: [2, 16, 28, 38]
[MaskedTreeAE] masked nodes: [3, 12, 22, 32, 44, 60, 114, 152]
[MaskedTreeAE] masked nodes: [8, 23, 43, 89, 94, 100, 124, 130]
[MaskedTreeAE] masked nodes: [3, 4, 11, 29]
[MaskedTreeAE] masked nodes: [0, 13, 65, 69, 76, 110, 116, 140]
[MaskedTreeAE] masked nodes: [5, 13, 18, 43, 47, 61, 119, 138]
[MaskedTreeAE] masked nodes: [7, 9, 16, 43]
[MaskedTreeAE] masked nodes: [8, 47, 69, 113, 120, 130, 139, 146]
[MaskedTreeAE] masked nodes: [0, 22, 25, 59, 70, 73, 85, 104]
[MaskedTreeAE] masked nodes: [0, 5, 21, 55]
[MaskedTreeAE] masked nodes: [0, 23, 38, 45, 95, 112, 136, 152]
[MaskedTreeAE] masked nodes: [1, 30, 61, 66, 70, 114, 125, 136]
[MaskedTreeAE] masked nodes: [11, 19, 21, 34]
[MaskedTreeAE] masked nodes: [4, 13, 21, 24, 33, 68, 122, 153]
[MaskedTreeAE] masked nodes: [34, 59, 81, 98, 103, 115, 127, 141]
[MaskedTreeAE] masked nodes: [5, 17, 20, 35]
[MaskedTreeAE] masked nodes: [4, 9, 24, 48, 72, 83, 98, 104]
[MaskedTreeAE] masked nodes: [7, 8, 20, 80, 93, 107, 125, 128]
[MaskedTreeAE] masked nodes: [23, 52, 93, 106]
[MaskedTreeAE] masked nodes: [7, 18, 32, 38, 56, 113, 117, 139]
[MaskedTreeAE] masked nodes: [13, 21, 54, 76, 85, 93, 97, 129]
[MaskedTreeAE] masked nodes: [6, 19, 28, 57]
[MaskedTreeAE] masked nodes: [8, 16, 23, 39, 48, 56, 63, 107]
[MaskedTreeAE] masked nodes: [6, 18, 29, 39, 46, 59, 67, 78]
[MaskedTreeAE] masked nodes: [11, 23, 81, 127]
[MaskedTreeAE] masked nodes: [2, 11, 23, 40, 58, 62, 71, 82]
[MaskedTreeAE] masked nodes: [8, 46, 59, 71, 73, 89, 106, 117]
[MaskedTreeAE] masked nodes: [12, 29, 79, 106]
[MaskedTreeAE] masked nodes: [2, 23, 34, 37, 49, 52, 78, 124]
[MaskedTreeAE] masked nodes: [10, 18, 36, 79, 88, 96, 149, 157]
[MaskedTreeAE] masked nodes: [23, 43, 46, 52]
[MaskedTreeAE] masked nodes: [3, 20, 45, 51, 63, 73, 79, 80]
[MaskedTreeAE] masked nodes: [15, 42, 90, 108, 131, 140, 147, 165]
[MaskedTreeAE] masked nodes: [7, 12, 19, 32]
[MaskedTreeAE] masked nodes: [5, 13, 28, 43, 57, 68, 86, 88]
[MaskedTreeAE] masked nodes: [25, 61, 93, 107, 139, 150, 153, 169]
[MaskedTreeAE] masked nodes: [14, 20, 25, 76]
[MaskedTreeAE] masked nodes: [6, 13, 36, 57, 114, 132, 162, 169]
[MaskedTreeAE] masked nodes: [14, 59, 77, 87, 102, 115, 122, 128]
[MaskedTreeAE] masked nodes: [8, 20, 35, 41]
[MaskedTreeAE] masked nodes: [1, 11, 21, 27, 49, 77, 100, 134]
[MaskedTreeAE] masked nodes: [5, 19, 34, 80, 95, 110, 118, 136]
[MaskedTreeAE] masked nodes: [7, 15, 18, 23]
[MaskedTreeAE] masked nodes: [1, 21, 29, 59, 83, 107, 114, 130]
[MaskedTreeAE] masked nodes: [6, 11, 75, 81, 88, 100, 138, 155]
[MaskedTreeAE] masked nodes: [2, 17, 23, 29]
[MaskedTreeAE] masked nodes: [6, 14, 23, 37, 45, 66, 87, 132]
[MaskedTreeAE] masked nodes: [5, 7, 60, 82, 141, 144, 155, 163]
[MaskedTreeAE] masked nodes: [1, 12, 22, 39]
epoch 020 | train 0.1942 | val 0.1442 | 0.1s
[MaskedTreeAE] masked nodes: [9, 18, 73, 92, 94, 113, 118, 129]
[MaskedTreeAE] masked nodes: [11, 17, 25, 34, 69, 73, 82, 119]
[MaskedTreeAE] masked nodes: [1, 13, 59, 72]
[MaskedTreeAE] masked nodes: [9, 20, 31, 48, 55, 61, 75, 151]
[MaskedTreeAE] masked nodes: [0, 12, 32, 33, 65, 76, 87, 92]
[MaskedTreeAE] masked nodes: [0, 24, 35, 75]
[MaskedTreeAE] masked nodes: [0, 49, 60, 69, 77, 83, 88, 94]
[MaskedTreeAE] masked nodes: [1, 22, 37, 50, 64, 71, 93, 128]
[MaskedTreeAE] masked nodes: [3, 39, 80, 100]
[MaskedTreeAE] masked nodes: [1, 9, 40, 64, 77, 84, 89, 131]
[MaskedTreeAE] masked nodes: [0, 19, 30, 41, 53, 67, 106, 137]
[MaskedTreeAE] masked nodes: [5, 20, 57, 60]
[MaskedTreeAE] masked nodes: [4, 9, 17, 25, 49, 61, 65, 81]
[MaskedTreeAE] masked nodes: [16, 61, 80, 114, 155, 170, 198, 230]
[MaskedTreeAE] masked nodes: [1, 19, 20, 27]
[MaskedTreeAE] masked nodes: [0, 8, 23, 54, 62, 73, 78, 103]
[MaskedTreeAE] masked nodes: [11, 44, 52, 62, 78, 99, 143, 161]
[MaskedTreeAE] masked nodes: [6, 55, 69, 75]
[MaskedTreeAE] masked nodes: [0, 17, 29, 39, 47, 137, 175, 218]
[MaskedTreeAE] masked nodes: [0, 15, 19, 25, 39, 56, 71, 81]
[MaskedTreeAE] masked nodes: [7, 19, 33, 42]
[MaskedTreeAE] masked nodes: [6, 11, 18, 40, 57, 94, 133, 151]
[MaskedTreeAE] masked nodes: [4, 20, 22, 35, 42, 57, 89, 114]
[MaskedTreeAE] masked nodes: [39, 49, 62, 65]
[MaskedTreeAE] masked nodes: [10, 18, 23, 29, 41, 55, 68, 90]
[MaskedTreeAE] masked nodes: [3, 15, 39, 45, 86, 92, 150, 174]
[MaskedTreeAE] masked nodes: [6, 13, 18, 39]
[MaskedTreeAE] masked nodes: [9, 48, 69, 79, 92, 102, 109, 131]
[MaskedTreeAE] masked nodes: [4, 52, 61, 68, 91, 131, 153, 168]
[MaskedTreeAE] masked nodes: [7, 10, 30, 35]
[MaskedTreeAE] masked nodes: [12, 14, 23, 35, 75, 110, 120, 150]
[MaskedTreeAE] masked nodes: [12, 18, 24, 41, 99, 107, 114, 122]
[MaskedTreeAE] masked nodes: [6, 10, 14, 30]
[MaskedTreeAE] masked nodes: [20, 50, 62, 104, 158, 173, 187, 206]
[MaskedTreeAE] masked nodes: [2, 9, 18, 52, 65, 75, 87, 93]
[MaskedTreeAE] masked nodes: [12, 14, 23, 40]
[MaskedTreeAE] masked nodes: [1, 11, 56, 82, 95, 130, 159, 165]
[MaskedTreeAE] masked nodes: [1, 10, 28, 34, 52, 69, 78, 127]
[MaskedTreeAE] masked nodes: [8, 13, 33, 34]
[MaskedTreeAE] masked nodes: [3, 5, 55, 101, 159, 170, 175, 182]
[MaskedTreeAE] masked nodes: [6, 12, 26, 33, 46, 57, 67, 74]
[MaskedTreeAE] masked nodes: [5, 11, 34, 48]
[MaskedTreeAE] masked nodes: [8, 25, 35, 70, 104, 109, 126, 131]
[MaskedTreeAE] masked nodes: [11, 57, 76, 107, 114, 118, 123, 134]
[MaskedTreeAE] masked nodes: [1, 10, 56, 80]
[MaskedTreeAE] masked nodes: [5, 11, 18, 37, 40, 62, 106, 173]
[MaskedTreeAE] masked nodes: [5, 22, 61, 67, 74, 90, 91, 106]
[MaskedTreeAE] masked nodes: [1, 22, 36, 41]
[MaskedTreeAE] masked nodes: [29, 34, 66, 83, 107, 120, 128, 135]
[MaskedTreeAE] masked nodes: [5, 12, 19, 27, 39, 80, 94, 120]
[MaskedTreeAE] masked nodes: [18, 20, 30, 40]
[MaskedTreeAE] masked nodes: [10, 14, 100, 104, 114, 160, 162, 181]
[MaskedTreeAE] masked nodes: [9, 23, 27, 44, 60, 76, 89, 95]
[MaskedTreeAE] masked nodes: [4, 12, 18, 61]
[MaskedTreeAE] masked nodes: [29, 49, 56, 72, 167, 171, 178, 194]
[MaskedTreeAE] masked nodes: [3, 7, 18, 29, 34, 41, 57, 74]
[MaskedTreeAE] masked nodes: [12, 25, 62, 74]
[MaskedTreeAE] masked nodes: [1, 21, 50, 68, 113, 132, 178, 199]
[MaskedTreeAE] masked nodes: [6, 9, 17, 22, 34, 42, 61, 86]
[MaskedTreeAE] masked nodes: [11, 18, 27, 43]
epoch 040 | train 0.1630 | val 0.1079 | 0.0s
[MaskedTreeAE] masked nodes: [9, 16, 33, 95, 115, 123, 130, 148]
[MaskedTreeAE] masked nodes: [4, 7, 12, 46, 54, 120, 150, 153]
[MaskedTreeAE] masked nodes: [5, 16, 22, 38]
[MaskedTreeAE] masked nodes: [12, 36, 44, 64, 69, 77, 103, 174]
[MaskedTreeAE] masked nodes: [7, 19, 31, 43, 56, 93, 114, 122]
[MaskedTreeAE] masked nodes: [0, 8, 11, 20]
[MaskedTreeAE] masked nodes: [3, 10, 27, 41, 52, 60, 71, 79]
[MaskedTreeAE] masked nodes: [4, 42, 53, 60, 65, 80, 89, 114]
[MaskedTreeAE] masked nodes: [25, 57, 65, 75]
[MaskedTreeAE] masked nodes: [4, 28, 66, 109, 118, 125, 130, 165]
[MaskedTreeAE] masked nodes: [5, 16, 28, 30, 54, 61, 72, 81]
[MaskedTreeAE] masked nodes: [10, 41, 52, 63]
[MaskedTreeAE] masked nodes: [2, 45, 50, 56, 70, 108, 124, 126]
[MaskedTreeAE] masked nodes: [2, 53, 58, 72, 78, 83, 107, 121]
[MaskedTreeAE] masked nodes: [10, 39, 69, 83]
[MaskedTreeAE] masked nodes: [1, 8, 27, 53, 72, 81, 101, 110]
[MaskedTreeAE] masked nodes: [2, 12, 23, 25, 42, 72, 93, 103]
[MaskedTreeAE] masked nodes: [4, 27, 35, 120]
[MaskedTreeAE] masked nodes: [5, 11, 25, 33, 51, 91, 121, 130]
[MaskedTreeAE] masked nodes: [3, 10, 23, 35, 68, 100, 109, 119]
[MaskedTreeAE] masked nodes: [0, 13, 18, 46]
[MaskedTreeAE] masked nodes: [0, 22, 62, 78, 89, 101, 110, 121]
[MaskedTreeAE] masked nodes: [28, 59, 69, 76, 128, 151, 165, 168]
[MaskedTreeAE] masked nodes: [2, 4, 38, 54]
[MaskedTreeAE] masked nodes: [2, 20, 33, 46, 54, 67, 119, 153]
[MaskedTreeAE] masked nodes: [1, 8, 26, 27, 42, 94, 108, 112]
[MaskedTreeAE] masked nodes: [3, 55, 64, 74]
[MaskedTreeAE] masked nodes: [10, 16, 29, 77, 88, 99, 142, 164]
[MaskedTreeAE] masked nodes: [2, 16, 26, 67, 75, 95, 100, 120]
[MaskedTreeAE] masked nodes: [6, 27, 39, 49]
[MaskedTreeAE] masked nodes: [3, 12, 14, 25, 35, 96, 134, 158]
[MaskedTreeAE] masked nodes: [15, 80, 81, 90, 100, 114, 120, 124]
[MaskedTreeAE] masked nodes: [2, 13, 39, 48]
[MaskedTreeAE] masked nodes: [5, 14, 73, 79, 88, 97, 115, 125]
[MaskedTreeAE] masked nodes: [5, 18, 23, 38, 49, 60, 68, 118]
[MaskedTreeAE] masked nodes: [16, 35, 57, 96]
[early stop] no improvement for 10 epochs at epoch 52
[MaskedTreeAE] masked nodes: [3, 21, 32, 41]
[TEST] recon_only_masked=True | recon=0.1373
[TEST] recon_only_masked=False | recon=0.1239
[TEST] recon_only_masked=True | mask_mode=one | mask_k=5 | red=mean | recon=0.1359

--- Reconstruction error on ORIGINAL scale (per feature) ---
idx | feature            |          MAE |         RMSE
--------------------------------------------------------
  0 | deg                |     0.118282 |     0.118282
  1 | depth              |    0.0813506 |    0.0899381
  2 | mass               |    0.0127053 |    0.0129284
  3 | j_revo             |         0.25 |          0.5
  4 | j_cont             |         0.25 |          0.5
  5 | j_pris             |            0 |            0
  6 | j_fix              |            0 |            0
  7 | axis_x             |     0.267497 |     0.320628
  8 | axis_y             |     0.195627 |     0.201367
  9 | axis_z             |     0.176778 |     0.180966
 10 | origin_x           |     0.118699 |     0.157713
 11 | origin_y           |    0.0933592 |     0.115886
 12 | origin_z           |     0.202411 |     0.223195
--------------------------------------------------------

--- Error rate by Min–Max range (sorted by MAE rate, desc) ---
rank | idx | feature            |       MAE |     width | (MAE/width)% |  (RMSE/width)%
------------------------------------------------------------------------------
   1 |   4 | j_cont             |      0.25 |         1 |        25.00 |          50.00
   2 |   3 | j_revo             |      0.25 |         1 |        25.00 |          50.00
   3 |  12 | origin_z           |    0.2024 |     1.121 |        18.06 |          19.91
   4 |  10 | origin_x           |    0.1187 |     0.747 |        15.89 |          21.11
   5 |   7 | axis_x             |    0.2675 |         2 |        13.37 |          16.03
   6 |  11 | origin_y           |   0.09336 |     0.794 |        11.76 |          14.60
   7 |   8 | axis_y             |    0.1956 |         2 |         9.78 |          10.07
   8 |   9 | axis_z             |    0.1768 |         2 |         8.84 |           9.05
   9 |   0 | deg                |    0.1183 |         7 |         1.69 |           1.69
  10 |   1 | depth              |   0.08135 |        11 |         0.74 |           0.82
  11 |   2 | mass               |   0.01271 |      97.2 |         0.01 |           0.01
  12 |   5 | j_pris             |         0 |         1 |         0.00 |           0.00
  13 |   6 | j_fix              |         0 |         1 |         0.00 |           0.00
------------------------------------------------------------------------------
